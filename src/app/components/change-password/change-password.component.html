<div class="container mt-5">
  <h2>Change Password</h2>
  <form [formGroup]="changePasswordForm" (ngSubmit)="onChangePassword()">
    <div class="mb-3">
      <label for="oldPassword" class="form-label">Old Password</label>
      <div class="input-group">
        <input [type]="oldPasswordVisible ? 'text' : 'password'" class="form-control" id="oldPassword" formControlName="oldPassword" required>
        <button class="btn btn-outline-secondary" type="button" (click)="togglePasswordVisibility('oldPassword')">
          <i class="bi" [ngClass]="oldPasswordVisible ? 'bi-eye-slash' : 'bi-eye'"></i>
        </button>
      </div>
      <div *ngIf="changePasswordForm.get('oldPassword')?.touched && changePasswordForm.get('oldPassword')?.errors?.['required']" class="text-danger">
        Old password is required
      </div>
    </div>
    <div class="mb-3">
      <label for="newPassword" class="form-label">New Password</label>
      <div class="input-group">
        <input [type]="newPasswordVisible ? 'text' : 'password'" class="form-control" id="newPassword" formControlName="newPassword" required>
        <button class="btn btn-outline-secondary" type="button" (click)="togglePasswordVisibility('newPassword')">
          <i class="bi" [ngClass]="newPasswordVisible ? 'bi-eye-slash' : 'bi-eye'"></i>
        </button>
      </div>
      <div *ngIf="changePasswordForm.get('newPassword')?.touched && changePasswordForm.get('newPassword')?.errors?.['required']" class="text-danger">
        New password is required
      </div>
      <div *ngIf="changePasswordForm.get('newPassword')?.touched && changePasswordForm.get('newPassword')?.errors?.['invalidPassword']" class="text-danger">
        Password must be at least 7 characters long, contain 1 uppercase letter, 1 number, and 1 special character
      </div>
    </div>
    <div class="mb-3">
      <label for="confirmPassword" class="form-label">Confirm Password</label>
      <div class="input-group">
        <input [type]="confirmPasswordVisible ? 'text' : 'password'" class="form-control" id="confirmPassword" formControlName="confirmPassword" required>
        <button class="btn btn-outline-secondary" type="button" (click)="togglePasswordVisibility('confirmPassword')">
          <i class="bi" [ngClass]="confirmPasswordVisible ? 'bi-eye-slash' : 'bi-eye'"></i>
        </button>
      </div>
      <div *ngIf="changePasswordForm.get('confirmPassword')?.touched && changePasswordForm.get('confirmPassword')?.errors?.['required']" class="text-danger">
        Confirm password is required
      </div>
    </div>
    <div *ngIf="changePasswordForm.errors?.['mismatch'] && changePasswordForm.get('newPassword')?.touched && changePasswordForm.get('confirmPassword')?.touched" class="text-danger mb-3">
      Passwords do not match
    </div>
    <button type="submit" class="btn btn-primary" [disabled]="changePasswordForm.invalid">Change Password</button>
    <div *ngIf="errorMessage" class="alert alert-danger mt-3">{{ errorMessage }}</div>
  </form>
</div>
